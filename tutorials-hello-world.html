<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Distributed Publish &amp; Subscribe for IoT: Hello world</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Distributed Publish &amp; Subscribe for IoT
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('tutorials-hello-world.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Hello world </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#hello-world-prerequisites">Prerequisites</a></li>
<li class="level1"><a href="#creating-a-node">Creating a node</a></li>
<li class="level1"><a href="#starting-a-node">Starting a node</a></li>
<li class="level1"><a href="#publishing">Publishing</a><ul><li class="level2"><a href="#creating-a-publication">Creating a publication</a></li>
<li class="level2"><a href="#sending-a-publication">Sending a publication</a></li>
</ul>
</li>
<li class="level1"><a href="#subscribing">Subscribing</a><ul><li class="level2"><a href="#creating-a-subscription">Creating a subscription</a></li>
<li class="level2"><a href="#receiving-a-publication">Receiving a publication</a></li>
</ul>
</li>
<li class="level1"><a href="#acknowledging">Acknowledging</a><ul><li class="level2"><a href="#requesting-an-acknowledgement">Requesting an acknowledgement</a></li>
<li class="level2"><a href="#sending-an-acknowledgement">Sending an acknowledgement</a></li>
<li class="level2"><a href="#receiving-an-acknowledgement">Receiving an acknowledgement</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="hello-world-prerequisites"></a>
Prerequisites</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dbg_8h.html">dps/dbg.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dps_8h.html">dps/dps.h</a>&gt;</span></div></div><!-- fragment --><p> The first step in creating a DPS application is to include the necessary header files.</p>
<h1><a class="anchor" id="creating-a-node"></a>
Creating a node</h1>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *separators = <span class="stringliteral">&quot;/.&quot;</span>;</div><div class="line">    <a class="code" href="group__keystore.html#gaf3833cfe48f848f698514bc5daa075fa">DPS_KeyStore</a>* keyStore = NULL;</div><div class="line">    <span class="keyword">const</span> <a class="code" href="struct___d_p_s___key_id.html">DPS_KeyId</a>* keyId = NULL;</div><div class="line">    <a class="code" href="group__node.html#ga4dd612ab965134321bb57fdb065f121c">DPS_Node</a>* node = <a class="code" href="group__node.html#gaf6641b5bbf27b2c45ac7f926b0ce4efe">DPS_CreateNode</a>(separators, keyStore, keyId);</div><div class="line">    <span class="keywordflow">if</span> (!node) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Each entity in DPS is represented by a <code>DPS_Node</code>. The node may be a publisher, subscriber, both, or neither. For this example, we're going to be creating publisher and subscriber nodes.</p>
<p>Creating a node requires three parameters: the topic separators, a key store, and a key identifier. For now we're only concerned with the separators. Key stores and identifiers are covered later when discussing how to secure communications.</p>
<p>The separators parameter is a string containing the characters used as topic level separators. Providing <code>/</code>. as the separators parameter value allows both <code>/</code> and <code></code>. as separators.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__node.html#gad19cf4272ba11e935654175c83db2ce1" title="Store a pointer to application data in a node. ">DPS_SetNodeData()</a>, <a class="el" href="group__node.html#ga65bba7bcfe5e940b153fcced4e2e8880" title="Get application data pointer previously set by DPS_SetNodeData() ">DPS_GetNodeData()</a></dd></dl>
<h1><a class="anchor" id="starting-a-node"></a>
Starting a node</h1>
<div class="fragment"><div class="line">    <span class="keywordtype">int</span> mcastPub = <a class="code" href="group__node.html#ga178a3a6450eeff450820fa34fd82049c">DPS_MCAST_PUB_ENABLE_SEND</a> | <a class="code" href="group__node.html#gae493573fb2e02b87258952223eb4fcd7">DPS_MCAST_PUB_ENABLE_RECV</a>;</div><div class="line">    uint16_t listenPort = 0;</div><div class="line">    <a class="code" href="group__status.html#ga30395a84d3cad9d4ec29848106415038">DPS_Status</a> ret = <a class="code" href="group__node.html#ga160d504bfaeb0d3711e0259000340fe3">DPS_StartNode</a>(node, mcastPub, listenPort);</div><div class="line">    <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Once created, a node must be started. Starting a node enables it to begin sending and receiving DPS messages in the network.</p>
<p>For this example, we are going to be sending and receiving multicast publications so we enable both and let DPS assign the listening port.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__node.html#gac939c83361ed89086f37c78d9c9009dd" title="Disable multicast send and receive on the node. ">DPS_MCAST_PUB_DISABLED</a>, <a class="el" href="group__node.html#gaf920b28fe0721a7f97b11673494d7b36" title="Get the port number this node is listening for connections on. ">DPS_GetPortNumber()</a></dd></dl>
<h1><a class="anchor" id="publishing"></a>
Publishing</h1>
<h2><a class="anchor" id="creating-a-publication"></a>
Creating a publication</h2>
<div class="fragment"><div class="line">    <a class="code" href="group__publication.html#ga0d439693474aa54e27f3d45a054696ac">DPS_Publication</a>* pub = <a class="code" href="group__publication.html#gaca070a96a6374e99a05d647c10737962">DPS_CreatePublication</a>(node);</div><div class="line">    <span class="keywordflow">if</span> (!pub) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* topics[] = {</div><div class="line">        <span class="stringliteral">&quot;a/b/c/d&quot;</span></div><div class="line">    };</div><div class="line">    <span class="keywordtype">size_t</span> numTopics = A_SIZEOF(topics);</div><div class="line">    <span class="keywordtype">int</span> noWildCard = <a class="code" href="dps_8h.html#ad8b397975a479b996ef223367d8835a9">DPS_FALSE</a>;</div><div class="line">    ret = <a class="code" href="group__publication.html#ga7b0709e28cb34d5a30b90e4142cd6c19">DPS_InitPublication</a>(pub, topics, numTopics, noWildCard, NULL, NULL);</div><div class="line">    <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Each publication in DPS is represented by a <code>DPS_Publication</code>. Each publication has a set of topics, a UUID, and a sequence number. In this example we are creating a publication with one topic, <code>a/b/c/d</code>. The UUID is assigned by DPS and the sequence number will be incremented each time we publish.</p>
<p>The <code>noWildCard</code> parameter is used by the publisher to control whether a subscription is required to match the publication's topics exactly or can use wildcards to match the topics. If we set <code>noWildCard</code> to <code>DPS_TRUE</code> then only a subscription to <code>a/b/c/d</code> will receive this publication. This allows the publisher to prevent publications being sent to catchall subscriptions such as <code>+/#</code>. Since we set <code>noWildCard</code> to <code>DPS_FALSE</code> here, subscriptions to <code>a/#</code>, <code>a/+/+/d</code>, or similar variations will receive this publication.</p>
<p>Both the publication's key identifier and acknowledgement handler are set to <code>NULL</code> here; they are covered in later sections.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__publication.html#ga91c46ccb6df7f4bb99ca5d9d35cc5a4a" title="Store a pointer to application data in a publication. ">DPS_SetPublicationData()</a>, <a class="el" href="group__publication.html#gaa8bee35089ac62289c9ba0e6a0568ca0" title="Get application data pointer previously set by DPS_SetPublicationData() ">DPS_GetPublicationData()</a>, <a class="el" href="group__publication.html#gad2a37d52f12c93434b431eefd732f363" title="Get the local node associated with a publication. ">DPS_PublicationGetNode()</a>, <a class="el" href="group__publication.html#gaba1ad3ee807b75a1281d334be06a12f7" title="Get the UUID for a publication. ">DPS_PublicationGetUUID()</a>, <a class="el" href="group__publication.html#ga875b48217d861d4a9fa5471419d354e9" title="Get the sequence number for a publication. ">DPS_PublicationGetSequenceNum()</a></dd></dl>
<h2><a class="anchor" id="sending-a-publication"></a>
Sending a publication</h2>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* payload = <span class="stringliteral">&quot;Hello&quot;</span>;</div><div class="line">    <span class="keywordtype">size_t</span> numPayloadBytes = strlen(payload) + 1;</div><div class="line">    int16_t ttl = 0;</div><div class="line">    ret = <a class="code" href="group__publication.html#ga828a4efc5c235c48a81f6460cc3fe416">DPS_Publish</a>(pub, (<span class="keyword">const</span> uint8_t*)payload, numPayloadBytes, ttl);</div><div class="line">    <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Once created and initialized with a set of topics, application payloads may be sent. Payload data is simply an array of bytes in DPS, no assumptions are made with regards to the payload format.</p>
<p>In this example the <code>ttl</code> parameter is zero, indicating that the publication will be sent best-effort to all active subscribing nodes. A non-zero ttl is referred to as a retained publication and is covered later.</p>
<p>A publisher may send additional publications via the same <code>DPS_Publication</code>. Each additional send increments the sequence number of the publication.</p>
<h1><a class="anchor" id="subscribing"></a>
Subscribing</h1>
<h2><a class="anchor" id="creating-a-subscription"></a>
Creating a subscription</h2>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* topics[] = {</div><div class="line">        <span class="stringliteral">&quot;a/b/c/d&quot;</span></div><div class="line">    };</div><div class="line">    <span class="keywordtype">size_t</span> numTopics = A_SIZEOF(topics);</div><div class="line">    <a class="code" href="group__subscription.html#gadb927c4c1b7306867a75fc4288b54af7">DPS_Subscription</a>* sub = <a class="code" href="group__subscription.html#ga4095bb00bd0ca7fa9614ebbc2c28199f">DPS_CreateSubscription</a>(node, topics, numTopics);</div><div class="line">    <span class="keywordflow">if</span> (!sub) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Each subscription in DPS is represented by a <code>DPS_Subscription</code>. In this example we are creating a subscription with one topic with no wildcards, <code>a/b/c/d</code>.</p>
<p>Wildcards may be used to match a broader set of topics. A <code>+</code> matches any single topic level, and a <code>#</code> matches all topic levels from that level on. In this instance since the publisher is allowing wildcard matching, the subscriber could use either <code>a/b/+/d</code> or <code>a/#</code> (among others) as the topic and still receive the publication.</p>
<p>A subscription may also be created with multiple topics. The publication must include <em>all</em> of the topics to be received.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__subscription.html#gad581d341003e20c714061e44b57c2009" title="Store a pointer to application data in a subscription. ">DPS_SetSubscriptionData()</a>, <a class="el" href="group__subscription.html#ga88ab2284734f099ef67bcc60997142b3" title="Get application data pointer previously set by DPS_SetSubscriptionData() ">DPS_GetSubscriptionData()</a>, <a class="el" href="group__subscription.html#gafea65751c811555736c8c65fcb3a9480" title="Get the local node associated with a subscription. ">DPS_SubscriptionGetNode()</a></dd></dl>
<h2><a class="anchor" id="receiving-a-publication"></a>
Receiving a publication</h2>
<div class="fragment"><div class="line">        ret = <a class="code" href="group__subscription.html#ga83234ea82a91e07e3f5894a4dcf5267e">DPS_Subscribe</a>(sub, PublicationHandler);</div><div class="line">        <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">            <span class="keywordflow">goto</span> Exit;</div><div class="line">        }</div></div><!-- fragment --><p> Publications are received asynchronously. The first step in receiving a publication is to provide the publication handler to DPS and start the subscription. The publication handler will be called for each received publication.</p>
<dl class="section note"><dt>Note</dt><dd>Each instance of <code>DPS_Node</code> creates and runs its own thread. The lifetime of this thread is the same as the lifetime of the node. The publication handler is dispatched from this thread.</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> PublicationHandler(<a class="code" href="group__subscription.html#gadb927c4c1b7306867a75fc4288b54af7">DPS_Subscription</a>* sub, <span class="keyword">const</span> <a class="code" href="group__publication.html#ga0d439693474aa54e27f3d45a054696ac">DPS_Publication</a>* pub,</div><div class="line">                               uint8_t* payload, <span class="keywordtype">size_t</span> numPayloadBytes)</div><div class="line">{</div><div class="line">    <span class="keywordtype">size_t</span> i;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__subscription.html#gab0ad2c6806f8f44f27c70fff915b7e9a">DPS_SubscriptionGetNumTopics</a>(sub); ++i) {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* topic = <a class="code" href="group__subscription.html#gaacc63deda2f2d97cf3f44ca84784b2f6">DPS_SubscriptionGetTopic</a>(sub, i);</div><div class="line">        <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;subscription topic[%ld]=%s\n&quot;</span>, i, topic);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">const</span> <a class="code" href="struct___d_p_s___u_u_i_d.html">DPS_UUID</a>* uuid = <a class="code" href="group__publication.html#gaba1ad3ee807b75a1281d334be06a12f7">DPS_PublicationGetUUID</a>(pub);</div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;uuid=%s\n&quot;</span>, <a class="code" href="group__uuid.html#ga9c51faa57ecb228ce7eda077a90b20ff">DPS_UUIDToString</a>(uuid));</div><div class="line"></div><div class="line">    uint32_t n = <a class="code" href="group__publication.html#ga875b48217d861d4a9fa5471419d354e9">DPS_PublicationGetSequenceNum</a>(pub);</div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;sequence number=%d\n&quot;</span>, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__publication.html#gaee6fc3b13484faacff0d26646778f777">DPS_PublicationGetNumTopics</a>(pub); ++i) {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* topic = <a class="code" href="group__publication.html#ga143a5c6fbe0bdf1725e841f122582432">DPS_PublicationGetTopic</a>(pub, i);</div><div class="line">        <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;publication topic[%ld]=%s\n&quot;</span>, i, topic);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;payload=%.*s\n&quot;</span>, numPayloadBytes, payload);</div><div class="line">}</div></div><!-- fragment --><p> This publication handler exercises the APIs for retrieving the subscription and publication information.</p>
<h1><a class="anchor" id="acknowledging"></a>
Acknowledging</h1>
<p>Acknowledgements provide an optional means for subscribers to reply to publications. For example, they may be used when the publication is logically a request and the acknowledgements are responses. Similar to publications, acknowledgements may include an application payload, and no assumptions are made by DPS with regards to the acknowledgement payload format.</p>
<h2><a class="anchor" id="requesting-an-acknowledgement"></a>
Requesting an acknowledgement</h2>
<div class="fragment"><div class="line">    <a class="code" href="group__publication.html#ga0d439693474aa54e27f3d45a054696ac">DPS_Publication</a>* pub = <a class="code" href="group__publication.html#gaca070a96a6374e99a05d647c10737962">DPS_CreatePublication</a>(node);</div><div class="line">    <span class="keywordflow">if</span> (!pub) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* topics[] = {</div><div class="line">        <span class="stringliteral">&quot;a/b/c/d&quot;</span></div><div class="line">    };</div><div class="line">    <span class="keywordtype">size_t</span> numTopics = A_SIZEOF(topics);</div><div class="line">    <span class="keywordtype">int</span> noWildCard = <a class="code" href="dps_8h.html#ad8b397975a479b996ef223367d8835a9">DPS_FALSE</a>;</div><div class="line">    ret = <a class="code" href="group__publication.html#ga7b0709e28cb34d5a30b90e4142cd6c19">DPS_InitPublication</a>(pub, topics, numTopics, noWildCard, NULL,</div><div class="line">                              AcknowledgementHandler);</div><div class="line">    <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">        <span class="keywordflow">goto</span> Exit;</div><div class="line">    }</div></div><!-- fragment --><p> Requesting an acknowledgement is identical to <a class="el" href="tutorials-hello-world.html#creating-a-publication">Creating a publication</a>, with the addition of the <code>DPS_AcknowledgementHandler</code>.</p>
<h2><a class="anchor" id="sending-an-acknowledgement"></a>
Sending an acknowledgement</h2>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group__publication.html#ga516f7f314c7b95210751d00285758b9b">DPS_PublicationIsAckRequested</a>(pub)) {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* payload = <span class="stringliteral">&quot;World&quot;</span>;</div><div class="line">        <span class="keywordtype">size_t</span> numPayloadBytes = strlen(payload) + 1;</div><div class="line">        <a class="code" href="group__status.html#ga30395a84d3cad9d4ec29848106415038">DPS_Status</a> ret = <a class="code" href="group__publication.html#ga308074429a566ffb8d04d55bae520b04">DPS_AckPublication</a>(pub, (<span class="keyword">const</span> uint8_t*)payload, numPayloadBytes);</div><div class="line">        <span class="keywordflow">if</span> (ret != <a class="code" href="group__status.html#ga0ea3dd37bc558859ae0cb5a4f79a4bdd">DPS_OK</a>) {</div><div class="line">            <span class="keywordflow">goto</span> Exit;</div><div class="line">        }</div><div class="line">    }</div></div><!-- fragment --><p> To determine if a publication has requested an ack, call <a class="el" href="group__publication.html#ga516f7f314c7b95210751d00285758b9b" title="Check if an acknowledgement was requested for a publication. ">DPS_PublicationIsAckRequested()</a>. To send an acknowledgement, along with any optional acknowledgement payload, call <a class="el" href="group__publication.html#ga308074429a566ffb8d04d55bae520b04" title="Acknowledge a publication. ">DPS_AckPublication()</a>.</p>
<p>The <code>pub</code> parameter of the publication handler is only valid during the body of the handler. In order to acknowledge a publication after the handler has returned, the application must first call <a class="el" href="group__publication.html#ga41f31a8b63558e13d73d96de6086e5c4" title="Creates a partial copy of a publication that can be used to acknowledge the publication. ">DPS_CopyPublication()</a> to create a partial copy of the publication. The copy may be used after the handler returns.</p>
<h2><a class="anchor" id="receiving-an-acknowledgement"></a>
Receiving an acknowledgement</h2>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> AcknowledgementHandler(<a class="code" href="group__publication.html#ga0d439693474aa54e27f3d45a054696ac">DPS_Publication</a>* pub,</div><div class="line">                                   uint8_t* payload, <span class="keywordtype">size_t</span> numPayloadBytes)</div><div class="line">{</div><div class="line">    <span class="keywordtype">size_t</span> i;</div><div class="line"></div><div class="line">    <span class="keyword">const</span> <a class="code" href="struct___d_p_s___u_u_i_d.html">DPS_UUID</a>* uuid = <a class="code" href="group__publication.html#gaba1ad3ee807b75a1281d334be06a12f7">DPS_PublicationGetUUID</a>(pub);</div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;uuid=%s\n&quot;</span>, <a class="code" href="group__uuid.html#ga9c51faa57ecb228ce7eda077a90b20ff">DPS_UUIDToString</a>(uuid));</div><div class="line"></div><div class="line">    uint32_t n = <a class="code" href="group__publication.html#ga875b48217d861d4a9fa5471419d354e9">DPS_PublicationGetSequenceNum</a>(pub);</div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;sequence number=%d\n&quot;</span>, n);</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group__publication.html#gaee6fc3b13484faacff0d26646778f777">DPS_PublicationGetNumTopics</a>(pub); ++i) {</div><div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* topic = <a class="code" href="group__publication.html#ga143a5c6fbe0bdf1725e841f122582432">DPS_PublicationGetTopic</a>(pub, i);</div><div class="line">        <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;publication topic[%ld]=%s\n&quot;</span>, i, topic);</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="group__debug.html#gaf1d25cc7f1d2d92f96ba620217af28fd">DPS_PRINT</a>(<span class="stringliteral">&quot;payload=%.*s\n&quot;</span>, numPayloadBytes, payload);</div><div class="line">}</div></div><!-- fragment --><p> Acknowledgements are received asynchronously. The acknowledgement handler will be called for each received acknowledgement.</p>
<p>This acknowledgement handler exercises the APIs for retrieving the publication information associated with the acknowledgement.</p>
<dl class="section note"><dt>Note</dt><dd>The acknowledgement handler is dispatched from the <code>DPS_Node's</code> thread. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div class="navpath" id="nav-path">
  <ul>
    <li class="footer" style="float:left"><b>Distributed Publish & Subscribe for IoT</b></li> <li class="footer">Generated Fri Jun 8 2018 15:56:01</li>
  </ul>
</div>
</body>
</html>
